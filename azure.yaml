# yaml-language-server: $schema=https://raw.githubusercontent.com/Azure/azure-dev/main/schemas/v1.0/azure.yaml.json

name: contoso-real-estate
metadata:
  template: contoso-real-estate@0.0.1
hooks:
  postprovision:
    shell: "sh"
    continueOnError: false
    interactive: true

    # TODO: provide a cross platform way to run this script
    run: ./scripts/database/restore.sh strapi_20230922

services:
  portal:
    project: packages/portal
    dist: dist/contoso-app
    language: ts
    host: staticwebapp
    module: app/portal
    # The postpackage hook has been removed as the predeploy.js script is not present
    # and its necessity for the deployment process is unclear.
    # If required, the correct script path or alternative commands should be provided.

  notifications:
    project: packages/notifications
    docker:
      context: .
      path: ./Dockerfile
    language: js
    host: containerapp
    module: app/notifications

  api:
    project: packages/api
    language: ts
    host: function
    module: app/api

  cms:
    project: packages/blog-cms
    host: containerapp
    language: js
    module: app/cms

  blog:
    project: packages/blog
    host: containerapp
    language: js
    module: app/blog

  stripe:
    project: packages/stripe
    host: containerapp
    language: js
    docker:
      context: ../..
    module: app/stripe
